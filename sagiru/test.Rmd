---
title: "Untitled"
output: 
  bookdown::pdf_document2:
   keep_tex: true
header-includes:
  - \usepackage[caption=false]{subfig}
  - \usepackage{float}
date: '2022-06-11'
---

```{r setup, include=FALSE}
library(EviewsR)
knitr::opts_chunk$set(echo = T,prompt = T,fig.align = "center",fig.pos="h",eval = T,fig.show = 'hold',out.width="20%")
# out.extra = 'style="border:5px solid orange;"'
# set_eviews_path("eviews10")
```


```{eviews ev,eval=TRUE,graph=''}
#| fig.cap: Figures automatically imported by eviews chunk (page="eviewsr page1", graph="asis")
#| fig.subcap: !expr paste0(rep("Graph",6),3:1," of ",rep(c("EviewsR","Page1"),each=3)," page")
#| graph_procs: [template bokeh, setelem(1) lcolor(green) fillcolor(green)]
#| out.width: '30%'
#| graph: asis
#| fig.align: center
#| page: "*" 
#| echo: no
#| eval: true
#| 

'This is some comment in EViews program, feel free to write anything

wfcreate(page=EviewsR_page,wf=EviewsR_workfile) m 2000 2022
!n=1
for %y  page2 EviewsR3 page1 
pagecreate(page={%y}) q 2000 2022
pageselect {%y}
rndseed !n+100
!n=!n+100
genr x=@cumsum(nrnd)
genr y=@cumsum(nrnd)
genr z=@cumsum(nrnd)
equation OLS_EQUATION.ls y c x z
freeze(OLS_EQUATION_TABLE,mode=overwrite) OLS_EQUATION
delete(noerr) GRAPH*
freeze(GRAPH3,mode=overwrite) z.line
graph GRAPH2.dot y
graph GRAPH1.area x
graph3.addtext(ar) %y
graph2.addtext(ar) %y
graph1.addtext(ar) %y
next

wfsave eviewsr1
```

`r ev$page1_ols_equation$r2`

```{r import,eval=TRUE}
import_table('eviewsr1')

ev$page1_ols_equation
ev$page1
ev$eviewsr3_ols_equation_table
ls(envir = ev)
```

```{r,echo=FALSE,eval=TRUE}
x=runif(100)
y=runif(100)
EviewsRDataFrame=data.frame(x,y)
dir.create('EviewsR_files/')
write.csv(EviewsRDataFrame,"EviewsR_Files/EviewsR_eviews_import.csv",row.names = FALSE)
```

```{r}
ev$page1 |> head()

ev$page2 |> head()

ev$eviewsr3 |> head()

```

```{r eviewsImport,eval=TRUE}
eviews_import(source_description = "EviewsR_Files/EviewsR_eviews_import.csv",frequency = "m",start_date = "1990",save_path ='EviewsR_Files' )
```


```{r eviewsImport1,eval=TRUE}

eviews_import(source_description = "EviewsR_files/EviewsR_eviews_import.csv",smpl_string = "1990m10 1992m11",
rename_string = "x x2")

```



```{r eviews12,fig.cap='rotated'}
import_workfile('eviewsr1',graph ="*",graph_procs = 'template midnight',page='eviewsr3')

```



```{r eviews13,fig.cap='imported'}
import_graph('eviewsr1',graph ="*",graph_procs = 'template midnight')

```

```{r}
eviews12$page1
eviews12$page2_ols_equation
eviews12$eviewsr3

```



```{r import1,fig.cap='dd'}

import_workfile(wf="EviewsR1",page = "EviewsR3")
import$eviewsr3
# eviews$importedDataFrame %>% head

# kable(head(eviews$importedDataFrame),
# caption="Imported series converted to table",booktabs=T,linesep="") %>%  kable_styling(latex_options = "HOLD_position")

```
